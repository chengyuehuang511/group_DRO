Dataset: CUB
Shift type: confounder
Target name: waterbird_complete95
Confounder names: ['forest2water2']
Resume: False
Inference: False
Minority fraction: None
Imbalance ratio: None
Fraction: 1.0
Root dir: ./
Reweight groups: False
Augment data: False
Val fraction: 0.1
Robust: False
Alpha: 0.2
Generalization adjustment: 0.0
Automatic adjustment: False
Robust step size: 0.01
Use normalized loss: False
Btl: False
Hinge: False
Print grad loss: False
Print feat: False
Uniform loss: False
Model: resnet50
Train from scratch: False
N epochs: 3
Batch size: 128
Lr: 0.001
Scheduler: False
Weight decay: 0.0001
Gamma: 0.1
Minimum variational weight: 0
Seed: 0
Show progress: True
Log dir: ./logs_metrics_acc
Checkpoint dir: ./logs_a40
Log every: 50
Save step: 1000
Save best: True
Save last: True

Training Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 3498
    waterbird_complete95 = 0, forest2water2 = 1: n = 184
    waterbird_complete95 = 1, forest2water2 = 0: n = 56
    waterbird_complete95 = 1, forest2water2 = 1: n = 1057
Validation Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 467
    waterbird_complete95 = 0, forest2water2 = 1: n = 466
    waterbird_complete95 = 1, forest2water2 = 0: n = 133
    waterbird_complete95 = 1, forest2water2 = 1: n = 133
Test Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 2255
    waterbird_complete95 = 0, forest2water2 = 1: n = 2255
    waterbird_complete95 = 1, forest2water2 = 0: n = 642
    waterbird_complete95 = 1, forest2water2 = 1: n = 642

Epoch [0]:
Training:
Average incurred loss: 0.317  
Average sample loss: 0.314  
Average acc: 0.877  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 3498]:	loss = 0.157  exp loss = 0.090  adjusted loss = 0.090  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 184]:	loss = 0.559  exp loss = 0.807  adjusted loss = 0.807  adv prob = 0.250000   acc = 0.723
  waterbird_complete95 = 1, forest2water2 = 0  [n = 56]:	loss = 1.414  exp loss = 1.435  adjusted loss = 1.435  adv prob = 0.250000   acc = 0.054
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1057]:	loss = 0.744  exp loss = 0.472  adjusted loss = 0.472  adv prob = 0.250000   acc = 0.556

Validation:
Average incurred loss: 0.616  
Average sample loss: 0.604  
Average acc: 0.681  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.082  exp loss = 0.078  adjusted loss = 0.078  adv prob = 0.250000   acc = 0.985
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 1.052  exp loss = 1.065  adjusted loss = 1.065  adv prob = 0.250000   acc = 0.410
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.401  exp loss = 1.546  adjusted loss = 1.546  adv prob = 0.250000   acc = 0.286
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.181  exp loss = 0.236  adjusted loss = 0.236  adv prob = 0.250000   acc = 0.962
Current lr: 0.001000
Current validation accuracy: 0.6814011335372925
Best model saved at epoch 0


Epoch [1]:
Training:
Average incurred loss: 0.129  
Average sample loss: 0.129  
Average acc: 0.955  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 3498]:	loss = 0.048  exp loss = 0.051  adjusted loss = 0.051  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 184]:	loss = 0.844  exp loss = 0.782  adjusted loss = 0.782  adv prob = 0.250000   acc = 0.516
  waterbird_complete95 = 1, forest2water2 = 0  [n = 56]:	loss = 1.394  exp loss = 1.233  adjusted loss = 1.233  adv prob = 0.250000   acc = 0.339
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1057]:	loss = 0.205  exp loss = 0.160  adjusted loss = 0.160  adv prob = 0.250000   acc = 0.930

Validation:
Average incurred loss: 0.472  
Average sample loss: 0.458  
Average acc: 0.777  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.036  exp loss = 0.031  adjusted loss = 0.031  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.691  exp loss = 0.712  adjusted loss = 0.712  adv prob = 0.250000   acc = 0.631
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.540  exp loss = 1.767  adjusted loss = 1.767  adv prob = 0.250000   acc = 0.338
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.168  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 0.970
Current lr: 0.001000
Current validation accuracy: 0.7773144245147705
Best model saved at epoch 1


Epoch [2]:
Training:
Average incurred loss: 0.087  
Average sample loss: 0.087  
Average acc: 0.969  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 3498]:	loss = 0.024  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 184]:	loss = 0.467  exp loss = 0.485  adjusted loss = 0.485  adv prob = 0.250000   acc = 0.755
  waterbird_complete95 = 1, forest2water2 = 0  [n = 56]:	loss = 1.127  exp loss = 1.073  adjusted loss = 1.073  adv prob = 0.250000   acc = 0.500
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1057]:	loss = 0.174  exp loss = 0.161  adjusted loss = 0.161  adv prob = 0.250000   acc = 0.935

Validation:
Average incurred loss: 0.431  
Average sample loss: 0.417  
Average acc: 0.819  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.030  exp loss = 0.023  adjusted loss = 0.023  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.632  exp loss = 0.662  adjusted loss = 0.662  adv prob = 0.250000   acc = 0.702
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.420  exp loss = 1.648  adjusted loss = 1.648  adv prob = 0.250000   acc = 0.459
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.148  exp loss = 0.194  adjusted loss = 0.194  adv prob = 0.250000   acc = 0.962
Current lr: 0.001000
Current validation accuracy: 0.8190158009529114
Best model saved at epoch 2

