Dataset: CUB
Shift type: confounder
Target name: waterbird_complete95
Confounder names: ['forest2water2']
Resume: False
Inference: False
Minority fraction: None
Imbalance ratio: None
Fraction: 1.0
Root dir: ./
Reweight groups: False
Augment data: False
Val fraction: 0.1
Robust: False
Alpha: 0.2
Generalization adjustment: 0.0
Automatic adjustment: False
Robust step size: 0.01
Use normalized loss: False
Btl: False
Hinge: False
Model: resnet50
Train from scratch: False
N epochs: 300
Batch size: 128
Lr: 0.001
Scheduler: False
Weight decay: 0.0001
Gamma: 0.1
Minimum variational weight: 0
Seed: 0
Show progress: True
Log dir: ./logs_metrics_tmp_2
Checkpoint dir: ./logs_a40
Log every: 50
Save step: 1000
Save best: True
Save last: True

Training Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 3498
    waterbird_complete95 = 0, forest2water2 = 1: n = 184
    waterbird_complete95 = 1, forest2water2 = 0: n = 56
    waterbird_complete95 = 1, forest2water2 = 1: n = 1057
Validation Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 467
    waterbird_complete95 = 0, forest2water2 = 1: n = 466
    waterbird_complete95 = 1, forest2water2 = 0: n = 133
    waterbird_complete95 = 1, forest2water2 = 1: n = 133
Test Data...
    waterbird_complete95 = 0, forest2water2 = 0: n = 2255
    waterbird_complete95 = 0, forest2water2 = 1: n = 2255
    waterbird_complete95 = 1, forest2water2 = 0: n = 642
    waterbird_complete95 = 1, forest2water2 = 1: n = 642

Epoch [0]:
Training:
Average incurred loss: 0.317  
Average sample loss: 0.314  
Average acc: 0.877  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 3498]:	loss = 0.157  exp loss = 0.090  adjusted loss = 0.090  adv prob = 0.250000   acc = 0.995
  waterbird_complete95 = 0, forest2water2 = 1  [n = 184]:	loss = 0.559  exp loss = 0.807  adjusted loss = 0.807  adv prob = 0.250000   acc = 0.723
  waterbird_complete95 = 1, forest2water2 = 0  [n = 56]:	loss = 1.414  exp loss = 1.435  adjusted loss = 1.435  adv prob = 0.250000   acc = 0.054
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1057]:	loss = 0.744  exp loss = 0.472  adjusted loss = 0.472  adv prob = 0.250000   acc = 0.556

Validation:
Average incurred loss: 0.672  
Average sample loss: 0.662  
Average acc: 0.655  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.100  exp loss = 0.095  adjusted loss = 0.095  adv prob = 0.250000   acc = 0.983
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 1.214  exp loss = 1.231  adjusted loss = 1.231  adv prob = 0.250000   acc = 0.339
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.302  exp loss = 1.435  adjusted loss = 1.435  adv prob = 0.250000   acc = 0.293
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.156  exp loss = 0.204  adjusted loss = 0.204  adv prob = 0.250000   acc = 0.970
Current lr: 0.001000
Current validation accuracy: 0.6547122597694397
Best model saved at epoch 0


Epoch [1]:
Training:
Average incurred loss: 0.129  
Average sample loss: 0.129  
Average acc: 0.956  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 3498]:	loss = 0.046  exp loss = 0.036  adjusted loss = 0.036  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 0, forest2water2 = 1  [n = 184]:	loss = 0.811  exp loss = 0.695  adjusted loss = 0.695  adv prob = 0.250000   acc = 0.543
  waterbird_complete95 = 1, forest2water2 = 0  [n = 56]:	loss = 1.454  exp loss = 1.330  adjusted loss = 1.330  adv prob = 0.250000   acc = 0.304
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1057]:	loss = 0.215  exp loss = 0.201  adjusted loss = 0.201  adv prob = 0.250000   acc = 0.928

Validation:
Average incurred loss: 0.480  
Average sample loss: 0.466  
Average acc: 0.772  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.038  exp loss = 0.032  adjusted loss = 0.032  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.704  exp loss = 0.728  adjusted loss = 0.728  adv prob = 0.250000   acc = 0.620
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.557  exp loss = 1.771  adjusted loss = 1.771  adv prob = 0.250000   acc = 0.331
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.169  exp loss = 0.228  adjusted loss = 0.228  adv prob = 0.250000   acc = 0.970
Current lr: 0.001000
Current validation accuracy: 0.7723102569580078
Best model saved at epoch 1


Epoch [2]:
Training:
Average incurred loss: 0.084  
Average sample loss: 0.084  
Average acc: 0.971  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 3498]:	loss = 0.026  exp loss = 0.024  adjusted loss = 0.024  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 184]:	loss = 0.458  exp loss = 0.437  adjusted loss = 0.437  adv prob = 0.250000   acc = 0.761
  waterbird_complete95 = 1, forest2water2 = 0  [n = 56]:	loss = 1.160  exp loss = 1.233  adjusted loss = 1.233  adv prob = 0.250000   acc = 0.482
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1057]:	loss = 0.154  exp loss = 0.119  adjusted loss = 0.119  adv prob = 0.250000   acc = 0.943

Validation:
Average incurred loss: 0.440  
Average sample loss: 0.426  
Average acc: 0.811  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.032  exp loss = 0.025  adjusted loss = 0.025  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.657  exp loss = 0.690  adjusted loss = 0.690  adv prob = 0.250000   acc = 0.680
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.406  exp loss = 1.617  adjusted loss = 1.617  adv prob = 0.250000   acc = 0.466
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.144  exp loss = 0.187  adjusted loss = 0.187  adv prob = 0.250000   acc = 0.970
Current lr: 0.001000
Current validation accuracy: 0.8106756210327148
Best model saved at epoch 2


Epoch [3]:
Training:
Average incurred loss: 0.061  
Average sample loss: 0.061  
Average acc: 0.980  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 3498]:	loss = 0.021  exp loss = 0.022  adjusted loss = 0.022  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 184]:	loss = 0.361  exp loss = 0.358  adjusted loss = 0.358  adv prob = 0.250000   acc = 0.842
  waterbird_complete95 = 1, forest2water2 = 0  [n = 56]:	loss = 0.706  exp loss = 0.780  adjusted loss = 0.780  adv prob = 0.250000   acc = 0.679
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1057]:	loss = 0.105  exp loss = 0.106  adjusted loss = 0.106  adv prob = 0.250000   acc = 0.960

Validation:
Average incurred loss: 0.407  
Average sample loss: 0.392  
Average acc: 0.842  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.021  exp loss = 0.016  adjusted loss = 0.016  adv prob = 0.250000   acc = 0.998
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.553  exp loss = 0.584  adjusted loss = 0.584  adv prob = 0.250000   acc = 0.762
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.498  exp loss = 1.709  adjusted loss = 1.709  adv prob = 0.250000   acc = 0.459
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.156  exp loss = 0.194  adjusted loss = 0.194  adv prob = 0.250000   acc = 0.955
Current lr: 0.001000
Current validation accuracy: 0.8415346145629883
Best model saved at epoch 3


Epoch [4]:
Training:
Average incurred loss: 0.045  
Average sample loss: 0.046  
Average acc: 0.987  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 3498]:	loss = 0.014  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 0, forest2water2 = 1  [n = 184]:	loss = 0.246  exp loss = 0.334  adjusted loss = 0.334  adv prob = 0.250000   acc = 0.913
  waterbird_complete95 = 1, forest2water2 = 0  [n = 56]:	loss = 0.566  exp loss = 0.451  adjusted loss = 0.451  adv prob = 0.250000   acc = 0.786
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1057]:	loss = 0.083  exp loss = 0.061  adjusted loss = 0.061  adv prob = 0.250000   acc = 0.970

Validation:
Average incurred loss: 0.439  
Average sample loss: 0.426  
Average acc: 0.819  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.026  exp loss = 0.020  adjusted loss = 0.020  adv prob = 0.250000   acc = 0.994
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.701  exp loss = 0.745  adjusted loss = 0.745  adv prob = 0.250000   acc = 0.682
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.294  exp loss = 1.478  adjusted loss = 1.478  adv prob = 0.250000   acc = 0.541
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.117  exp loss = 0.140  adjusted loss = 0.140  adv prob = 0.250000   acc = 0.962
Current lr: 0.001000
Current validation accuracy: 0.8190158605575562


Epoch [5]:
Training:
Average incurred loss: 0.033  
Average sample loss: 0.033  
Average acc: 0.993  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 3498]:	loss = 0.011  exp loss = 0.014  adjusted loss = 0.014  adv prob = 0.250000   acc = 0.999
  waterbird_complete95 = 0, forest2water2 = 1  [n = 184]:	loss = 0.151  exp loss = 0.220  adjusted loss = 0.220  adv prob = 0.250000   acc = 0.967
  waterbird_complete95 = 1, forest2water2 = 0  [n = 56]:	loss = 0.445  exp loss = 0.474  adjusted loss = 0.474  adv prob = 0.250000   acc = 0.804
  waterbird_complete95 = 1, forest2water2 = 1  [n = 1057]:	loss = 0.065  exp loss = 0.052  adjusted loss = 0.052  adv prob = 0.250000   acc = 0.987

Validation:
Average incurred loss: 0.435  
Average sample loss: 0.421  
Average acc: 0.830  
  waterbird_complete95 = 0, forest2water2 = 0  [n = 467]:	loss = 0.023  exp loss = 0.017  adjusted loss = 0.017  adv prob = 0.250000   acc = 0.996
  waterbird_complete95 = 0, forest2water2 = 1  [n = 466]:	loss = 0.687  exp loss = 0.743  adjusted loss = 0.743  adv prob = 0.250000   acc = 0.706
  waterbird_complete95 = 1, forest2water2 = 0  [n = 133]:	loss = 1.315  exp loss = 1.495  adjusted loss = 1.495  adv prob = 0.250000   acc = 0.549
  waterbird_complete95 = 1, forest2water2 = 1  [n = 133]:	loss = 0.122  exp loss = 0.137  adjusted loss = 0.137  adv prob = 0.250000   acc = 0.962
